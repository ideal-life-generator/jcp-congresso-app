// Generated by CoffeeScript 1.7.1
(function() {
  var atea;

  atea = angular.module('atea');

  atea.directive('message', [
    'message', function(message) {
      return {
        restrict: 'E',
        template: '<div><div><p>~ message.message ~</p></div></div>',
        scope: true,
        controller: [
          '$scope', '$element', function($scope, $element) {
            $scope.message = message;
            return $scope.closeMessage = message.close;
          }
        ]
      };
    }
  ]);

  atea.directive('connection', [
    'connection', '$window', function(connection, $window) {
      return {
        restrict: 'E',
        scope: true,
        controller: [
          '$scope', function($scope) {
            $scope.connection = connection;
            $scope.$watch('connection', function() {
              return $scope.status = connection.status;
            }, true);
            $scope.refresh = function() {
              if (!connection.loading) {
                return $scope.connection.handler();
              }
            };
            return $window.ononline = function() {
              if (connection.handler) {
                return $scope.refresh();
              }
            };
          }
        ]
      };
    }
  ]);

  atea.directive('loader', [
    function() {
      return {
        restrict: 'E',
        template: '<div ng-show="loader" class="loader"> <div ng-show="loading" class="loading"> </div> <div ng-click="updater()" ng-show="warning" class="warning"> <p>~ noConnectionMessage ~</p> </div> </div>',
        replace: true,
        controller: ['$scope', function($scope) {}]
      };
    }
  ]);

  atea.directive('warning', [
    'connectionTest', '$window', function(connectionTest, $window) {
      return {
        restrict: 'C',
        controller: [
          '$scope', function($scope) {
            $scope.message = connectionTest.message;
            $scope.updater = function() {
              if (!$scope.update) {
                $scope.loading = true;
                $scope.warning = false;
                return $scope.f();
              }
            };
            return $window.ononline = function() {
              if ($scope.f) {
                return $scope.updater();
              }
            };
          }
        ]
      };
    }
  ]);

  atea.directive('cSwiperight', [
    '$timeout', function($timeout) {
      return {
        restrict: 'A',
        scope: true,
        controller: [
          '$scope', '$element', '$attrs', function($scope, $element, $attrs) {
            var element, mousemove, timeout, x, xS;
            x = xS = 0;
            timeout = null;
            mousemove = function(event) {
              event.stopPropagation();
              return x = event.clientX - xS;
            };
            return element = angular.element($element).on("mousedown", function(event) {
              event.stopPropagation();
              xS = event.clientX;
              $timeout(function() {
                if (window.innerWidth / 5 < x) {
                  return $scope[$attrs.cSwiperight]();
                }
              }, 150);
              return angular.element(this, event).on("mousemove", mousemove);
            }).on("mouseup", function(event) {
              var Xs;
              event.stopPropagation();
              x = Xs = 0;
              return angular.element(this, event).off("mousemove");
            });
          }
        ]
      };
    }
  ]);

  atea.directive('surveyText', [
    function() {
      return {
        restrict: 'E',
        replace: true,
        scope: {
          setting: '='
        },
        template: '<li> <h3>~setting.subject~</h3> <input type="text" class="form-control" name="~setting.name~" ng-model="setting.value" ng-minlength="~setting.min_length~" ng-maxlength="~setting.max_length~" ng-required="~setting.is_required~" placeholder="~setting.placeholder~"> <h4>~setting.intro~</h4> </li>',
        controller: ['$scope', function($scope) {}]
      };
    }
  ]);

  atea.directive('surveyTextarea', [
    function() {
      return {
        restrict: 'E',
        replace: true,
        scope: {
          setting: '='
        },
        template: '<li> <h3>~setting.subject~</h3> <textarea type="text" class="form-control" name="~setting.name~" ng-model="setting.value" ng-minlength="~setting.min_length~" ng-maxlength="~setting.max_length~" ng-required="~setting.is_required~" placeholder="~setting.placeholder~"> </textarea> <h4>~setting.intro~</h4> </li>',
        controller: ['$scope', function($scope) {}]
      };
    }
  ]);

  atea.directive('surveyCheckboxlist', [
    function() {
      return {
        restrict: 'E',
        replace: true,
        scope: {
          setting: '='
        },
        template: '<li> <h3>~setting.subject~</h3> <div	ng-repeat="checkbox in setting.options"> <label> <input type="checkbox" name="~setting.name~" value="~checkbox.answer_value~" ng-model="checkbox.value" ng-required="~setting.is_required~" placeholder="~setting.placeholder~"> ~ checkbox.subject ~ </label> </div> <h4>~setting.intro~</h4> </li>',
        controller: ['$scope', function($scope) {}]
      };
    }
  ]);

  atea.directive('surveyRadiolist', [
    function() {
      return {
        restrict: 'E',
        replace: true,
        scope: {
          setting: '='
        },
        template: '<li> <h3>~setting.subject~</h3> <div	ng-repeat="radio in setting.options"> <label> <input type="radio" name="~setting.name~" value="~radio.answer_value~" ng-model="setting.value" ng-required="~setting.is_required~" placeholder="~setting.placeholder~"> ~ radio.subject ~ </label> </div> <h4>~setting.intro~</h4> </li>',
        controller: ['$scope', function($scope) {}]
      };
    }
  ]);

  atea.directive('surveyDropdownlist', [
    function() {
      return {
        restrict: 'E',
        replace: true,
        scope: {
          setting: '='
        },
        template: '<li> <h3>~setting.subject~</h3> <div> <select class="form-control" name="~setting.name~" ng-model="setting.value" ng-required="~setting.is_required~" placeholder="~setting.placeholder~" ng-required="~setting.is_required~"> <option value="" disabled="~setting.is_required~">-- Select value --</option> <option ng-repeat="option in setting.options" type="radio" value="~option.answer_value~"> ~ option.subject ~ </option> </select> </div> <h4>~setting.intro~</h4> </li>',
        controller: ['$scope', function($scope) {}]
      };
    }
  ]);

  atea.directive('surveyEmail', [
    function() {
      return {
        restrict: 'E',
        replace: true,
        scope: {
          setting: '='
        },
        template: '<li> <h3>~setting.subject~</h3> <input type="email" class="form-control" name="~setting.name~" ng-model="setting.value" ng-minlength="0" ng-maxlength="250" ng-required="~setting.is_required~" ng-pattern="setting.pattern" placeholder="~setting.placeholder~"> <h4>~setting.intro~</h4> </li>',
        controller: [
          '$scope', function($scope) {
            return $scope.setting.pattern = /(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/;
          }
        ]
      };
    }
  ]);

  atea.directive('surveyNumber', [
    function() {
      return {
        restrict: 'E',
        replace: true,
        scope: {
          setting: '='
        },
        template: '<li> <h3>~setting.subject~</h3> <input type="number" class="form-control" name="~setting.name~" ng-model="setting.value" ng-minlength="~setting.min_length~" ng-maxlength="~setting.max_length~" ng-required="~setting.is_required~" placeholder="~setting.placeholder~"> <h4>~setting.intro~</h4> </li>',
        controller: ['$scope', function($scope) {}]
      };
    }
  ]);

  atea.directive('surveyMobile', [
    function() {
      return {
        restrict: 'E',
        replace: true,
        scope: {
          setting: '='
        },
        template: '<li> <h3>~setting.subject~</h3> <input type="text" class="form-control" name="~setting.name~" ng-model="setting.value" ng-minlength="~setting.min_length~" ng-maxlength="~setting.max_length~" ng-required="~setting.is_required~" placeholder="~setting.placeholder~"> <h4>~setting.intro~</h4> </li>',
        controller: ['$scope', function($scope) {}]
      };
    }
  ]);

  atea.directive('surveySmiles', [
    function() {
      return {
        restrict: 'E',
        replace: true,
        scope: {
          setting: '='
        },
        template: '<li> <h3>~setting.subject~</h3> <div	ng-repeat="smile in setting.options"> <label style="cursor: pointer; height: 2.3em;"> <input type="radio" style="margin-top: 0.3em;" name="~setting.name~" value="~smile.answer_value~" ng-model="setting.value" ng-required="~setting.is_required~" placeholder="~setting.placeholder~"> <img ng-src="img/~smile.subject~.png"/> <span>~smile.subject~</span> </label> </div> <h4>~setting.intro~</h4> </li>',
        controller: ['$scope', function($scope) {}]
      };
    }
  ]);

  atea.factory("loto", function() {
    var loto;
    return loto = {
      run: function(number, fn) {
        loto.number = number;
        return loto.afterFn = fn;
      },
      krugi: 1,
      speed: 1600,
      frames: 16,
      _count: 0
    };
  });

  atea.directive("loto", function(loto) {
    return {
      restrict: "C",
      controller: function($scope, $element) {
        $scope.length = [0, 1, 2];
        $scope.loto = loto;
        return $scope.$watch("loto._count", function(data) {
          if (data === 3) {
            loto.afterFn();
            return loto.afterFn = null;
          }
        });
      }
    };
  });

  atea.directive("items", function($timeout, loto) {
    return {
      restrict: "C",
      controller: function($scope) {
        return $scope.$watch("loto.number", function(data) {
          var start, step;
          if (data) {
            $scope.length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
            $scope.stylesheet = {
              top: null
            };
            start = 0;
            step = function() {
              var equal, now;
              now = new Date().getTime();
              equal = (now - start) / loto.speed;
              if (1242 * equal > step._count * 1242 / 9) {
                step._count++;
              }
              if (equal < 1 && loto.number[$scope.$index] > step._count - 1) {
                $scope.stylesheet.top = 1242 * equal + "px";
                return $timeout(step, loto.frames);
              } else {
                loto._count++;
                return $scope.stylesheet.top = (step._count - 1) * 1242 / 9 + "px";
              }
            };
            step._count = 0;
            step._krugi = 0;
            return $timeout(function() {
              start = new Date().getTime();
              return step();
            }, ($scope.$index + 1) * loto.speed / 9);
          }
        });
      }
    };
  });

  atea.directive("item", function() {
    return {
      restrict: "C",
      controller: function($scope) {
        $scope.stylesheet = {
          top: null
        };
        return $scope.stylesheet.top = $scope.$index * -138 + "px";
      }
    };
  });

}).call(this);
